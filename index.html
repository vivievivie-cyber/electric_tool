<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç·šå¾‘èˆ‡ç®¡å¾‘è¦åŠƒè¨ˆç®—æ©Ÿ</title>
    <style>
        /* --- åŸºç¤è¨­å®š --- */
        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
            margin: 0; padding: 15px; background-color: #f3f4f6; color: #333; 
            padding-bottom: 80px;
        }
        
        .header-container { display: flex; justify-content: center; align-items: center; margin-bottom: 20px; }
        h1 { margin: 0; font-size: 1.4rem; color: #1565c0; } 
        .help-btn {
            margin-left: 10px; background: #90a4ae; color: white; border: none; 
            width: 24px; height: 24px; border-radius: 50%; font-weight: bold; cursor: pointer;
        }

        .card {
            background: white; padding: 20px; border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08); margin-bottom: 15px;
            border: 1px solid #bbdefb;
        }

        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 6px; font-weight: 600; font-size: 0.95rem; color: #0d47a1; }

        select, input[type="number"] { 
            width: 100%; padding: 12px; border: 1px solid #90caf9; border-radius: 8px; 
            font-size: 16px; background: #fff; box-sizing: border-box; appearance: none;
        }
        select:focus, input:focus { border-color: #1565c0; outline: none; box-shadow: 0 0 0 3px rgba(21, 101, 192, 0.1); }

        /* çµæœå€å¡Š */
        .result-section {
            background-color: #e3f2fd; border: 2px solid #64b5f6;
            border-radius: 8px; padding: 15px; margin-top: 20px; display: none;
        }
        .res-block { border-bottom: 1px dashed #90caf9; padding-bottom: 15px; margin-bottom: 15px; }
        .res-block:last-child { border-bottom: none; margin-bottom: 0; }
        
        .res-title { font-size: 0.9rem; color: #1565c0; font-weight: bold; margin-bottom: 5px; text-transform: uppercase; letter-spacing: 1px;}
        .res-value { font-size: 1.5rem; font-weight: bold; color: #0d47a1; margin-bottom: 5px; }
        .res-detail { font-size: 0.9rem; color: #555; line-height: 1.5; }
        .tag-parallel { display: inline-block; background: #ff9800; color: #fff; padding: 2px 8px; border-radius: 10px; font-size: 0.8rem; margin-bottom: 5px;}

        .btn { 
            display: block; width: 100%; padding: 14px; border: none; border-radius: 8px; 
            font-size: 1rem; font-weight: bold; cursor: pointer; color: white; margin-top: 15px;
        }
        .btn-calc { background-color: #1565c0; }
        .btn-calc:active { background-color: #0d47a1; transform: translateY(1px); }

        /* Modal */
        .modal {
            display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.6); align-items: center; justify-content: center;
        }
        .modal-content {
            background-color: #fff; margin: 20px; padding: 20px; border-radius: 12px;
            width: 90%; max-width: 500px; max-height: 80vh; overflow-y: auto; position: relative;
        }
        .close-modal { position: absolute; top: 10px; right: 15px; color: #aaa; font-size: 28px; cursor: pointer; }
        h2 { border-bottom: 2px solid #1565c0; padding-bottom: 10px; font-size: 1.2rem; margin-top:0; color:#333;}
    </style>
</head>
<body>

    <div class="header-container">
        <h1>âš¡ ç·šå¾‘èˆ‡ç®¡å¾‘è¦åŠƒè¨ˆç®—æ©Ÿ</h1>
        <button class="help-btn" onclick="openModal()">?</button>
    </div>

    <div class="card">
        <div class="input-group">
            <label>1. ç„¡ç†”çµ²é–‹é—œ (NFB AT)</label>
            <input type="number" id="nfbValue" placeholder="å°ç…§åœ–å¡æ•¸å€¼ (å¦‚ 200, 800)" inputmode="decimal">
        </div>

        <div class="input-group">
            <label>2. é›»ç·šå®‰å…¨ä¿‚æ•¸ (å€æ•¸)</label>
            <input type="number" id="safetyFactor" value="1.0" step="0.05" placeholder="å¦‚ 1.0, 1.25">
            <div style="font-size:0.8rem; color:#666; margin-top:5px;">
                * é è¨­ 1.0 (ç›´æ¥æŸ¥è¡¨)ï¼Œè‹¥éœ€å¯¬è£•åº¦å¯è¼¸å…¥ 1.1 ç­‰ã€‚
            </div>
        </div>

        <div class="input-group">
            <label>3. çµ•ç·£å°ç·šç¨®é¡</label>
            <select id="wireType">
                <option value="xlpe">PEX/XLPE é›»çºœ (CV)</option>
                <option value="pvc_wire">PVC é›»ç·š (IV)</option>
                <option value="pvc_cable">PVC é›»çºœ (VV)</option>
            </select>
        </div>
        
        <div class="input-group">
            <label>4. é…ç½®å®¹å™¨é¡å‹</label>
            <select id="containerType" onchange="updateHint()">
                <option value="conduit_emt">å°ç·šç®¡ - EMT é‡‘å±¬ç®¡</option>
                <option value="conduit_pvc">å°ç·šç®¡ - PVC å¡‘è† ç®¡</option>
                <option value="conduit_rsc">å°ç·šç®¡ - RSG åšé‡‘å±¬ç®¡</option>
                <option value="tray">é‡‘å±¬ç·šæ§½ (Wireway)</option>
            </select>
            <div id="containerHint" style="font-size:0.8rem; color:#1565c0; margin-top:5px; font-weight:bold;">
                ç›®å‰è¨­å®šï¼šå°ç·šç®¡ (å¡«å……ç‡ 40%)
            </div>
        </div>

        <div class="input-group">
            <label>5. ç®¡å…§å°ç·šæ•¸ (ä¸å«æ¥åœ°)</label>
            <select id="wireCountSelect">
                <option value="3">3 æ¢ (å°ç…§åœ–å¡ç¬¬1æ¬„)</option>
                <option value="4">4 æ¢ (å°ç…§åœ–å¡ç¬¬2æ¬„)</option>
            </select>
            <div style="font-size:0.8rem; color:#d84315; margin-top:5px;">
                * ä¾æ“šåœ–å¡èˆ‡æ³•è¦æŸ¥è¡¨ã€‚
            </div>
        </div>

        <button class="btn btn-calc" onclick="calculate()">ğŸš€ è‡ªå‹•è¨ˆç®—</button>
    </div>

    <div id="resultArea" class="result-section">
        
        <div class="res-block">
            <div class="res-title">æ­¥é©Ÿä¸€ï¼šä¸»ç·šå¾‘ (æŸ¥è¡¨)</div>
            <div id="parallelTag" class="tag-parallel" style="display:none;">å¤šè¿´è·¯ä½µè¯</div>
            <div class="res-value" id="resWireSize">---</div>
            <div class="res-detail">
                <div>NFBï¼š<span id="resNFB">0</span> AT</div>
                <div>æ¯è·¯è² æ“”ï¼š<span id="resCurrentPerSet" style="color:#009688; font-weight:bold;">0</span> A</div>
                <div>æŸ¥è¡¨å®¹é‡ï¼š<span id="resWireCap">0</span> A (<span id="resWireConfigInfo"></span>)</div>
            </div>
        </div>

        <div class="res-block">
            <div class="res-title">æ­¥é©ŸäºŒï¼šéŠ…æ¥åœ°ç·š (G)</div>
            <div class="res-value" id="resGroundSize" style="color:#2e7d32;">---</div>
            <div class="res-detail">
                <div>ä¾æ“šï¼šåœ–å¡å³å´å°ç…§è¡¨ (è¡¨ 26-2)</div>
            </div>
        </div>

        <div class="res-block">
            <div class="res-title">æ­¥é©Ÿä¸‰ï¼šå»ºè­°å®¹å™¨é…ç½®</div>
            <div class="res-value" id="resContainerSize">---</div>
            <div class="res-detail">
                <div id="resPipeNote" style="display:none; color:#d84315; font-weight:bold; margin-bottom:5px;">
                    * å»ºè­°é…ç½® <span id="resPipeCount">1</span> æ”¯ç®¡ (æ¯ç®¡ä¸€è¿´è·¯)
                </div>
                <div>ç¸½æˆªé¢ç©ï¼š<span id="resTotalArea">0</span> mmÂ²</div>
                <div>æ³•è¦ä¸Šé™ï¼š<span id="resLimitInfo" style="font-weight:bold; color:#1565c0;"></span></div>
                <div>å¯¦éš›å¡«å……ç‡ï¼š<span id="resFillRate">0%</span></div>
            </div>
        </div>
    </div>

    <div id="helpModal" class="modal" onclick="closeModal(event)">
        <div class="modal-content">
            <span class="close-modal" onclick="document.getElementById('helpModal').style.display='none'">&times;</span>
            <h2>ğŸ“– æ•¸æ“šèˆ‡è¦å‰‡èªªæ˜</h2>
            
            <h4>1. è³‡æ–™åº«ä¾æ“š</h4>
            <ul>
                <li><strong>PVC é›»ç·š/é›»çºœï¼š</strong> ä¾ç…§æ‚¨æä¾›çš„ç¾å ´é€ŸæŸ¥åœ–å¡æ•¸æ“šã€‚</li>
                <li><strong>XLPE é›»çºœ (PEX)ï¼š</strong> 8mmÂ² ä»¥ä¸Šä¾ç…§åœ–å¡ï¼›2.0/3.5/5.5mmÂ² ä¾ç…§é›»å·¥æ³•è¦æ¨™æº–è£œå……ã€‚</li>
            </ul>

            <h4>2. æŸ¥è¡¨é‚è¼¯</h4>
            <p>ç›´æ¥ä¾æ“šã€Œ3æ¢ã€æˆ–ã€Œ4æ¢ã€è®€å–å°æ‡‰å®‰åŸ¹æ•¸ã€‚4æ¢ä¹‹æ•¸æ“šå·²åŒ…å«æ³•è¦æŠ˜æ¸›ã€‚</p>

            <h4>3. åˆ†è·¯åŸå‰‡</h4>
            <p>å–®ä¸€è¿´è·¯ç·šå¾‘é™åˆ¶ <strong>200mmÂ²</strong> ä»¥ä¸‹ã€‚è¶…éå‰‡è‡ªå‹•æ‹†åˆ†ç‚ºå¤šè¿´è·¯ã€‚</p>

            <div style="text-align:center; margin-top:20px;">
                <button onclick="document.getElementById('helpModal').style.display='none'" style="padding:10px 30px; border:none; background:#1565c0; color:white; border-radius:6px; cursor:pointer;">æˆ‘ç­è§£äº†</button>
            </div>
        </div>
    </div>

    <script>
        // --- 1. æ¥åœ°ç·šè³‡æ–™åº« (å®Œå…¨ä¾ç…§åœ–å¡å³å´) ---
        const db_ground_image = [
            { limit: 20,   s: "1.6mm", area: 12.6 },
            { limit: 30,   s: "2.0mm", area: 12.6 },
            { limit: 60,   s: "5.5mmÂ²", area: 28.3 },
            { limit: 100,  s: "8mmÂ²",   area: 44.2 },
            { limit: 200,  s: "14mmÂ²",  area: 63.6 },
            { limit: 400,  s: "22mmÂ²",  area: 95.0 },
            { limit: 600,  s: "38mmÂ²",  area: 147 },
            { limit: 800,  s: "50mmÂ²",  area: 184 },
            { limit: 1000, s: "60mmÂ²",  area: 219 },
            { limit: 1200, s: "80mmÂ²",  area: 275 },
            { limit: 1600, s: "100mmÂ²", area: 340 },
            { limit: 2000, s: "125mmÂ²", area: 415 },
            { limit: 2500, s: "175mmÂ²", area: 550 },
            { limit: 3000, s: "200mmÂ²", area: 615 },
            { limit: 4000, s: "250mmÂ²", area: 755 },
            { limit: 5000, s: "350mmÂ²", area: 1050 },
            { limit: 6000, s: "400mmÂ²", area: 1200 }
        ];

        // --- 2. ä¸»ç·šè³‡æ–™åº« ---
        // s: è¦æ ¼
        // v3: 3æ¢å®¹é‡
        // v4: 4æ¢å®¹é‡
        // a: å¤–å¾‘é¢ç© (ç®—ç®¡å¾‘ç”¨)
        // n: æ•¸å€¼å¤§å° (ç®—200é™åˆ¶ç”¨)

        const db_pvc_wire_img = [
            { s: "1.6mm", v3: 15, v4: 15, a: 10.2, n: 2 },
            { s: "2.0mm", v3: 20, v4: 20, a: 12.6, n: 3.5 }, 
            { s: "2mmÂ²",  v3: 15, v4: 15, a: 15.0, n: 2 },
            { s: "3.5mmÂ²", v3: 20, v4: 20, a: 19.6, n: 3.5 },
            { s: "5.5mmÂ²", v3: 30, v4: 28, a: 28.3, n: 5.5 },
            { s: "8mmÂ²",   v3: 40, v4: 35, a: 44.2, n: 8 },
            { s: "14mmÂ²",  v3: 55, v4: 50, a: 63.6, n: 14 },
            { s: "22mmÂ²",  v3: 70, v4: 65, a: 95.0, n: 22 },
            { s: "30mmÂ²",  v3: 90, v4: 80, a: 123, n: 30 },
            { s: "38mmÂ²",  v3: 100, v4: 90, a: 147, n: 38 },
            { s: "50mmÂ²",  v3: 120, v4: 110, a: 184, n: 50 },
            { s: "60mmÂ²",  v3: 140, v4: 125, a: 219, n: 60 },
            { s: "80mmÂ²",  v3: 165, v4: 145, a: 275, n: 80 },
            { s: "100mmÂ²", v3: 190, v4: 170, a: 340, n: 100 },
            { s: "125mmÂ²", v3: 220, v4: 200, a: 415, n: 125 },
            { s: "150mmÂ²", v3: 250, v4: 225, a: 483, n: 150 },
            { s: "200mmÂ²", v3: 300, v4: 270, a: 615, n: 200 },
            { s: "250mmÂ²", v3: 355, v4: 315, a: 755, n: 250 },
            { s: "325mmÂ²", v3: 415, v4: 370, a: 962, n: 325 }
        ];

        const db_pvc_cable_img = [
            { s: "1.6mm", v3: 15, v4: 13, a: 35, n: 2 },
            { s: "2.0mm", v3: 19, v4: 16, a: 35, n: 3.5 },
            { s: "3.5mmÂ²", v3: 19, v4: 16, a: 42, n: 3.5 },
            { s: "5.5mmÂ²", v3: 25, v4: 23, a: 55, n: 5.5 },
            { s: "8mmÂ²",   v3: 33, v4: 30, a: 70, n: 8 },
            { s: "14mmÂ²",  v3: 50, v4: 40, a: 100, n: 14 },
            { s: "22mmÂ²",  v3: 60, v4: 55, a: 150, n: 22 },
            { s: "30mmÂ²",  v3: 75, v4: 65, a: 200, n: 30 },
            { s: "38mmÂ²",  v3: 85, v4: 75, a: 230, n: 38 },
            { s: "50mmÂ²",  v3: 100, v4: 90, a: 300, n: 50 },
            { s: "60mmÂ²",  v3: 115, v4: 105, a: 360, n: 60 },
            { s: "80mmÂ²",  v3: 140, v4: 125, a: 450, n: 80 },
            { s: "100mmÂ²", v3: 160, v4: 150, a: 560, n: 100 },
            { s: "125mmÂ²", v3: 185, v4: 165, a: 650, n: 125 },
            { s: "150mmÂ²", v3: 215, v4: 190, a: 750, n: 150 },
            { s: "200mmÂ²", v3: 255, v4: 225, a: 900, n: 200 },
            { s: "250mmÂ²", v3: 300, v4: 265, a: 1100, n: 250 },
            { s: "325mmÂ²", v3: 355, v4: 310, a: 1350, n: 325 }
        ];

        const db_pex_img = [ // PEX = XLPE (å«è£œå›çš„å°ç·šå¾‘)
            { s: "2.0mmÂ²", v3: 25, v4: 20, a: 21.2, n: 2 }, // è£œå›
            { s: "3.5mmÂ²", v3: 30, v4: 24, a: 26.4, n: 3.5 }, // è£œå›
            { s: "5.5mmÂ²", v3: 40, v4: 32, a: 36.3, n: 5.5 }, // è£œå›
            { s: "8mmÂ²",   v3: 55, v4: 48, a: 47.8, n: 8 },
            { s: "14mmÂ²",  v3: 75, v4: 70, a: 67.9, n: 14 },
            { s: "22mmÂ²",  v3: 100, v4: 90, a: 98.5, n: 22 },
            { s: "30mmÂ²",  v3: 125, v4: 110, a: 127, n: 30 },
            { s: "38mmÂ²",  v3: 145, v4: 130, a: 154, n: 38 },
            { s: "50mmÂ²",  v3: 170, v4: 150, a: 191, n: 50 },
            { s: "60mmÂ²",  v3: 195, v4: 175, a: 227, n: 60 },
            { s: "80mmÂ²",  v3: 230, v4: 205, a: 284, n: 80 },
            { s: "100mmÂ²", v3: 265, v4: 240, a: 350, n: 100 },
            { s: "125mmÂ²", v3: 310, v4: 275, a: 423, n: 125 },
            { s: "150mmÂ²", v3: 355, v4: 315, a: 491, n: 150 },
            { s: "200mmÂ²", v3: 420, v4: 380, a: 625, n: 200 },
            { s: "250mmÂ²", v3: 500, v4: 450, a: 765, n: 250 },
            { s: "325mmÂ²", v3: 580, v4: 525, a: 973, n: 325 },
            { s: "400mmÂ²", v3: 670, v4: 600, a: 1150, n: 400 },
            { s: "500mmÂ²", v3: 755, v4: 680, a: 1400, n: 500 }
        ];

        // å®¹å™¨è³‡æ–™åº« (é€šç”¨)
        const pipe_emt = [ 
            { name: "E19 (3/4\")",  area: 286 }, { name: "E25 (1\")",    area: 506 },
            { name: "E31 (1-1/4\")", area: 872 }, { name: "E39 (1-1/2\")", area: 1195 },
            { name: "E51 (2\")",    area: 2042 }, { name: "E63 (2-1/2\")", area: 3060 },
            { name: "E75 (3\")",    area: 4675 }
        ];
        const pipe_pvc = [ 
            { name: "16mm", area: 162 }, { name: "20mm", area: 287 }, { name: "28mm", area: 512 },
            { name: "35mm", area: 812 }, { name: "41mm", area: 1162 }, { name: "52mm", area: 2000 },
            { name: "65mm", area: 2950 }, { name: "80mm", area: 4450 }
        ];
        const pipe_rsc = [
             { name: "G16", area: 212 }, { name: "G22", area: 387 }, { name: "G28", area: 650 },
             { name: "G36", area: 1137 }, { name: "G42", area: 1537 }, { name: "G54", area: 2525 },
             { name: "G70", area: 3687 }, { name: "G82", area: 5700 }
        ];
        const tray_sizes = [
            { name: "50x50 ç·šæ§½", area: 2500 }, { name: "100x50 ç·šæ§½", area: 5000 },
            { name: "100x100 ç·šæ§½", area: 10000 }, { name: "150x100 ç·šæ§½", area: 15000 },
            { name: "200x100 ç·šæ§½", area: 20000 }, { name: "300x100 ç·šæ§½", area: 30000 },
            { name: "400x100 ç·šæ§½", area: 40000 }, { name: "500x100 ç·šæ§½", area: 50000 },
            { name: "600x100 ç·šæ§½", area: 60000 }
        ];

        function updateHint() {
            const type = document.getElementById('containerType').value;
            const hint = document.getElementById('containerHint');
            if(type === 'tray') {
                hint.innerText = "ç›®å‰è¨­å®šï¼šç·šæ§½ (å¡«å……ç‡ 20%)";
            } else {
                hint.innerText = "ç›®å‰è¨­å®šï¼šå°ç·šç®¡ (å¡«å……ç‡ 40%)";
            }
        }

        function calculate() {
            const nfbAT = parseFloat(document.getElementById('nfbValue').value);
            const userSafety = parseFloat(document.getElementById('safetyFactor').value) || 1.0;
            const wireType = document.getElementById('wireType').value;
            const containerType = document.getElementById('containerType').value;
            const wireCountSel = document.getElementById('wireCountSelect').value;

            if (!nfbAT || nfbAT <= 0) { alert("è«‹è¼¸å…¥ NFB AT å€¼"); return; }

            // 1. é¸æ“‡è³‡æ–™åº«
            let db = null;
            if (wireType === 'pvc_wire') db = db_pvc_wire_img;
            else if (wireType === 'pvc_cable') db = db_pvc_cable_img;
            else db = db_pex_img;

            const isFourWire = (wireCountSel === "4");
            const configText = isFourWire ? "ç®¡å…§4æ¢" : "ç®¡å…§3æ¢";

            // 2. è‡ªå‹•åˆ†è·¯ Loop
            let bestSet = null;

            for (let sets = 1; sets <= 10; sets++) {
                
                let requiredAmp = (nfbAT * userSafety) / sets;

                // æ‰¾ç·š
                let found = null;
                for (let w of db) {
                    // æŸ¥è¡¨
                    let capacity = isFourWire ? w.v4 : w.v3;
                    if (capacity >= requiredAmp) {
                        found = w;
                        break; 
                    }
                }

                // 200mm2 é™åˆ¶
                if (found) {
                    if (found.n <= 200) {
                        bestSet = { sets: sets, wire: found, capacity: (isFourWire ? found.v4 : found.v3) };
                        break; 
                    } else {
                        continue;
                    }
                }
            }

            // 3. æ¥åœ°ç·š (ä¾ç¸½ NFB æŸ¥åœ–å¡)
            let foundGround = null;
            for (let g of db_ground_image) {
                if (g.limit >= nfbAT) { foundGround = g; break; }
            }
            if(!foundGround && nfbAT > 0) foundGround = db_ground_image[db_ground_image.length-1];


            // 4. é¡¯ç¤ºçµæœ
            document.getElementById('resultArea').style.display = 'block';
            document.getElementById('resNFB').innerText = nfbAT;

            if (bestSet) {
                const sets = bestSet.sets;
                const wire = bestSet.wire;
                
                document.getElementById('resCurrentPerSet').innerText = (nfbAT / sets).toFixed(1);
                document.getElementById('resWireCap').innerText = bestSet.capacity;
                document.getElementById('resWireConfigInfo').innerText = configText;

                if (sets > 1) {
                    document.getElementById('resWireSize').innerText = `${sets} è¿´è·¯ x ${wire.s}`;
                    document.getElementById('parallelTag').style.display = "inline-block";
                } else {
                    document.getElementById('resWireSize').innerText = wire.s;
                    document.getElementById('parallelTag').style.display = "none";
                }

                // æ¥åœ°
                if (foundGround) {
                    document.getElementById('resGroundSize').innerText = foundGround.s;
                } else {
                    document.getElementById('resGroundSize').innerText = "ç„¡ (NFBéå¤§æˆ–æœªå®šç¾©)";
                }

                // 5. è¨ˆç®—å®¹å™¨
                let mainCountPerSet = parseInt(wireCountSel); 
                let totalArea = (wire.a * mainCountPerSet * sets);
                if (foundGround) totalArea += foundGround.area;

                const isTray = (containerType === 'tray');
                let containerDB = [];
                let limitRatio = isTray ? 0.2 : 0.4;
                let areaForCheck = totalArea;
                
                if (isTray) {
                    containerDB = tray_sizes;
                    document.getElementById('resPipeNote').style.display = 'none';
                } else {
                    if (containerType === 'conduit_emt') containerDB = pipe_emt;
                    else if (containerType === 'conduit_pvc') containerDB = pipe_pvc;
                    else containerDB = pipe_rsc;

                    if (sets > 1) {
                        // åˆ†ç®¡
                        let singlePipeArea = (wire.a * mainCountPerSet);
                        if(foundGround) singlePipeArea += foundGround.area; 
                        areaForCheck = singlePipeArea;
                        document.getElementById('resPipeCount').innerText = sets;
                        document.getElementById('resPipeNote').style.display = 'block';
                    } else {
                        document.getElementById('resPipeNote').style.display = 'none';
                    }
                }

                let foundContainer = null;
                for (let c of containerDB) {
                    if ((c.area * limitRatio) >= areaForCheck) { foundContainer = c; break; }
                }

                document.getElementById('resTotalArea').innerText = totalArea.toFixed(1);
                document.getElementById('resLimitInfo').innerText = isTray ? "20%" : "40%";

                if (foundContainer) {
                    document.getElementById('resContainerSize').innerText = foundContainer.name;
                    const realRate = (areaForCheck / foundContainer.area) * 100;
                    document.getElementById('resFillRate').innerText = `${realRate.toFixed(1)}%`;
                } else {
                    document.getElementById('resContainerSize').innerText = "è¶…å‡ºè¦æ ¼";
                }

            } else {
                document.getElementById('resWireSize').innerText = "ç„¡é©åˆç·šå¾‘ (è² è¼‰éå¤§)";
                document.getElementById('resContainerSize').innerText = "-";
            }
        }

        function openModal() { document.getElementById('helpModal').style.display = 'flex'; }
        function closeModal(e) { if (e.target.className === 'modal') document.getElementById('helpModal').style.display = 'none'; }
    </script>
</body>
</html>
